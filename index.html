#include <Servo.h>

Servo servo;
const int pinServo = 3;

bool servoEnabled = true;     // pour STOP/RUN
bool cycleActive = false;     // pour CYCLE:ON/OFF

unsigned long cycleStart = 0;
unsigned long moveDuration = 1000;
unsigned long pauseDuration = 2000;

void setup() {
  Serial.begin(9600);
  servo.attach(pinServo);
  servo.write(0);
  Serial.println("READY");
}

void loop() {

  // ----- GESTION DU CYCLE -----
  if (cycleActive) {
    unsigned long t = millis() - cycleStart;

    if (t < moveDuration) {
      if (servoEnabled) servo.write(160);
    }
    else if (t < moveDuration + pauseDuration) {
      if (servoEnabled) servo.write(0);
    }
    else {
      cycleStart = millis();
    }
  }

  // ----- LECTURE DES COMMANDES WEB SERIAL -----
  if (Serial.available()) {
    String cmd = Serial.readStringUntil('\n');
    cmd.trim();
    handleCommand(cmd);
  }
}


// ====================================================
//                    P

